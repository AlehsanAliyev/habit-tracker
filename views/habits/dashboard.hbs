<div class="page-head">
  <div>
    <h1>Dashboard</h1>
    <p class="page-subtitle">Welcome, {{session.user.username}}. Keep the streak alive.</p>
  </div>
  <div class="page-actions">
    <a class="btn primary" href="/habits/add">Add Habit</a>
  </div>
</div>

{{#if habits.length}}
  <div class="card-grid">
    {{#each habits}}
      <div class="card habit-card">
        <div class="habit-head">
          <h3 class="habit-title">{{title}}</h3>
          <span class="pill">{{frequency}}</span>
        </div>

        <div class="habit-meta">
          {{#if weeklyTarget}}
            <div class="meta-line"><strong>Weekly target:</strong> {{weeklyTarget}}</div>
          {{/if}}
        </div>

        <div class="habit-spacer"></div>

        <div class="heatmap" aria-label="Last seven days">
          {{#each last7Days}}
            <span class="heatmap-square {{#if (eq score 2)}}is-good{{else if (eq score 1)}}is-warn{{else if (eq score 0)}}is-bad{{else if (eq score 'f')}}is-muted{{else}}is-empty{{/if}}"></span>
          {{/each}}
        </div>

        <div class="habit-actions">
          <a href="/logs/add/{{_id}}" class="btn primary small">Log today</a>
          <a href="/habits/edit/{{_id}}" class="btn ghost small">Edit</a>
          <a href="/habits/delete/{{_id}}" class="btn danger small" onclick="return confirm('Delete this habit?')">Delete</a>
        </div>
      </div>
    {{/each}}
  </div>
{{else}}
  <div class="card">
    <p class="card-meta">You have not added any habits yet.</p>
  </div>
{{/if}}
